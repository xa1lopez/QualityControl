<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>QualityControl: Advanced topics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QualityControl
   &#160;<span id="projectnumber">0.13.0</span>
   </div>
   <div id="projectbrief">O2 Data Quality Control Framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_doc_Advanced.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Advanced topics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a href="#advanced-topics">Advanced topics</a><ul>
<li><a href="#access-conditions-from-the-ccdb">Access conditions from the CCDB</a></li>
<li><a href="#definition-and-access-of-task-specific-configuration">Definition and access of task-specific configuration</a></li>
<li><a href="#custom-qc-object-metadata">Custom QC object metadata</a></li>
<li><a href="#data-inspector">Data Inspector</a><ul>
<li><a href="#prerequisite">Prerequisite</a></li>
<li><a href="#compilation">Compilation</a></li>
<li><a href="#execution">Execution</a></li>
<li><a href="#configuration">Configuration</a></li>
</ul>
</li>
<li><a href="#use-mysql-as-qc-backend">Use MySQL as QC backend</a></li>
<li><a href="#local-ccdb-setup">Local CCDB setup</a></li>
<li><a href="#local-qcg-qc-gui-setup">Local QCG (QC GUI) setup</a></li>
<li><a href="#information-service">Information Service</a><ul>
<li><a href="#usage">Usage</a></li>
</ul>
</li>
<li><a href="#configuration-files-details">Configuration files details</a></li>
</ul>
</li>
</ul>
<p>← Go back to Modules Development | ../README.md "↑ Go to the Table of Content ↑" | Continue to Frequently Asked Questions →</p>
<h2>Access conditions from the CCDB</h2>
<p>The MonitorObjects generated by Quality Control are stored in a dedicated repository based on CCDB. The run conditions, on the other hand, are located in another, separate database. One can access these conditions inside a Task by a dedicated method of the TaskInterface, as below: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;TObject* condition = TaskInterface::retrieveCondition(&quot;Path/to/condition&quot;);</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;if (condition) {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  LOG(INFO) &lt;&lt; &quot;Retrieved &quot; &lt;&lt; condition-&gt;ClassName();</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  delete condition;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;}</div></div><!-- fragment --><p> Make sure to declare a valid URL of CCDB in the config file. Keep in mind that it might be different from the CCDB instance used for storing QC objects.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  &quot;qc&quot;: {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    &quot;config&quot;: {</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     ...</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;      &quot;conditionDB&quot;: {</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        &quot;url&quot;: &quot;ccdb-test.cern.ch:8080&quot;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;      }</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    },</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    ...</div></div><!-- fragment --><h2>Definition and access of task-specific configuration</h2>
<p>A task can access custom parameters declared in the configuration file at <code>qc.tasks.&lt;task_name&gt;.taskParameters</code>. They are stored inside a key-value map named mCustomParameters, which is a protected member of <code>TaskInterface</code>.</p>
<p>One can also tell the DPL driver to accept new arguments. This is done using the <code>customize</code> method at the top of your workflow definition (usually called "runXXX" in the QC).</p>
<p>For example, to add two parameters of different types do : </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void customize(std::vector&lt;ConfigParamSpec&gt;&amp; workflowOptions)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  workflowOptions.push_back(</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    ConfigParamSpec{ &quot;config-path&quot;, VariantType::String, &quot;&quot;, { &quot;Path to the config file. Overwrite the default paths. Do not use with no-data-sampling.&quot; } });</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  workflowOptions.push_back(</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    ConfigParamSpec{ &quot;no-data-sampling&quot;, VariantType::Bool, false, { &quot;Skips data sampling, connects directly the task to the producer.&quot; } });</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div></div><!-- fragment --><h2>Custom QC object metadata</h2>
<p>One can add custom metadata on the QC objects produced in a QC task. Simply call <code>ObjectsManager::addMetadata(...)</code>, like in </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// add a metadata on histogram mHistogram, key is &quot;custom&quot; and value &quot;34&quot;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;getObjectsManager()-&gt;addMetadata(mHistogram-&gt;GetName(), &quot;custom&quot;, &quot;34&quot;);</div></div><!-- fragment --><p> This metadata will end up in the CCDB.</p>
<h2>Data Inspector</h2>
<p>This is a GUI to inspect the data coming out of the DataSampling, in particular the Readout.</p>
<div class="image">
<img src="images/dataDump.png"  alt="alt text"/>
</div>
<h3>Prerequisite</h3>
<p>If not already done, install GLFW for your platform. On CC7 install <code>glfw-devel</code> from epel repository : <code>sudo yum install glfw-devel --enablerepo=epel</code></p>
<h3>Compilation</h3>
<p>Build the QualityControl as usual.</p>
<h3>Execution</h3>
<p>To monitor the readout, 3 processes have to be started : the Readout, the Data Sampling and the Data Inspector.</p>
<p>First make sure that the Data Sampling is enabled in the readout : </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[consumer-data-sampling]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;consumerType=DataSampling</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;enabled=1</div></div><!-- fragment --><p>In 3 separate terminals, do respectively</p>
<ol type="1">
<li><code>readout.exe <a href="file:///absolute/path/to/config.cfg">file:///absolute/path/to/config.cfg</a></code></li>
<li><code>o2-qc-run-readout-for-data-dump --batch</code></li>
<li><code>o2-qc-data-dump --mq-config $QUALITYCONTROL_ROOT/etc/dataDump.json --id dataDump --control static</code></li>
</ol>
<h3>Configuration</h3>
<p><b>Fraction of data</b> The Data Sampling tries to take 100% of the events by default. Edit <code>$QUALITYCONTROL_ROOT/etc/readoutForDataDump.json</code> to change it. Look for the parameter <code>fraction</code> that is set to 1.</p>
<p><b>Port</b> The Data Sampling sends data to the GUI via the port <code>26525</code>. If this port is not free, edit the config file <code>$QUALITYCONTROL_ROOT/etc/readoutForDataDump.json</code> and <code>$QUALITYCONTROL_ROOT/etc/dataDump.json</code>.</p>
<h2>Use MySQL as QC backend</h2>
<ol type="1">
<li>Install the MySQL/MariaDB development package<ul>
<li>CC7 : <code>sudo yum install mariadb-server</code></li>
<li>Mac (or download the dmg from Oracle) : <code>brew install mysql</code></li>
</ul>
</li>
<li>Rebuild the QualityControl (so that the mysql backend classes are compiled)</li>
<li>Start and populate database :</li>
</ol>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo systemctl start mariadb # for CC7, check for your specific OS</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;alienv enter qcg/latest</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;o2-qc-database-setup.sh</div></div><!-- fragment --><h2>Local CCDB setup</h2>
<p>Having a central ccdb for test (ccdb-test) is handy but also means that everyone can access, modify or delete the data. If you prefer to have a local instance of the CCDB, for example in your lab or on your development machine, follow these instructions.</p>
<ol type="1">
<li>Download the local repository service from <a href="http://alimonitor.cern.ch/download/local.jar">http://alimonitor.cern.ch/download/local.jar</a></li>
<li>The service can simply be run with <code>java -jar local.jar</code></li>
</ol>
<p>It will start listening by default on port 8080. This can be changed either with the java parameter “tomcat.port” or with the environment variable “TOMCAT_PORT”. Similarly the default listening address is 127.0.0.1 and it can be changed with the java parameter “tomcat.address” or with the environment variable “TOMCAT_ADDRESS” to something else (for example ‘*’ to listen on all interfaces).</p>
<p>By default the local repository is located in /tmp/QC (or java.io.tmpdir/QC to be more precise). You can change this location in a similar way by setting the java parameter “file.repository.location” or the environment variable “FILE_REPOSITORY_LOCATION”.</p>
<p>The address of the CCDB will have to be updated in the Tasks config file.</p>
<p>At the moment, the description of the REST api can be found in this document : <a href="https://docs.google.com/presentation/d/1PJ0CVW7QHgnFzi0LELc06V82LFGPgmG3vsmmuurPnUg">https://docs.google.com/presentation/d/1PJ0CVW7QHgnFzi0LELc06V82LFGPgmG3vsmmuurPnUg</a></p>
<h2>Local QCG (QC GUI) setup</h2>
<p>To install and run the QCG locally, and its fellow process tobject2json, please follow these instructions : <a href="https://github.com/AliceO2Group/WebUi/tree/dev/QualityControl#run-qcg-locally">https://github.com/AliceO2Group/WebUi/tree/dev/QualityControl#run-qcg-locally</a></p>
<h2>Information Service</h2>
<p>The information service publishes information about the tasks currently running and the objects they publish. It is needed by some GUIs, or other clients.</p>
<p>By default it will publish on port 5561 the json description of a task when it is updated. A client can also request on port 5562 the information about a specific task or about all the tasks, by passing the name of the task as a parameter or "all" respectively.</p>
<p>The JSON for a task looks like : </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    &quot;name&quot;: &quot;myTask_1&quot;,</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    &quot;objects&quot;: [</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        {</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;            &quot;id&quot;: &quot;array-0&quot;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        },</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        {</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;            &quot;id&quot;: &quot;array-1&quot;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        },</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        {</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;            &quot;id&quot;: &quot;array-2&quot;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        },</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        {</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;            &quot;id&quot;: &quot;array-3&quot;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        },</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        {</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;            &quot;id&quot;: &quot;array-4&quot;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        }</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    ]</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;}</div></div><!-- fragment --><p>The JSON for all tasks looks like : </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    &quot;tasks&quot;: [</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        {</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;            &quot;name&quot;: &quot;myTask_1&quot;,</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;            &quot;objects&quot;: [</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;                {</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;                    &quot;id&quot;: &quot;array-0&quot;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;                },</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                {</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                    &quot;id&quot;: &quot;array-1&quot;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                }</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;            ]</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        },</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        {</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;            &quot;name&quot;: &quot;myTask_2&quot;,</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;            &quot;objects&quot;: [</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                {</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                    &quot;id&quot;: &quot;array-0&quot;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                },</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                    &quot;id&quot;: &quot;array-1&quot;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                }</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;            ]</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        }</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    ]</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div></div><!-- fragment --><p> ### Usage </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;o2-qc-info-service -c /absolute/path/to/InformationService.json -n information_service \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;              --id information_service --mq-config /absolute/path/to/InformationService.json</div></div><!-- fragment --><p>The <code>o2-qc-info-service</code> can provide fake data from a file. This is useful to test the clients. Use the option <code>--fake-data-file</code> and provide the absolute path to the file. The file <code>infoServiceFake.json</code> is provided as an example.</p>
<p>To check what is being output by the Information Service, one can run the <a class="el" href="classInformationServiceDump.html" title="Dump the publications received from the InformationService. ">InformationServiceDump</a> : </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;o2-qc-info-service-dump -c /absolute/path/to/InformationService.json -n information_service_dump \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;                  --id information_service_dump --mq-config /absolute/path/to/InformationService.json</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;                  --request-task myTask1</div></div><!-- fragment --><p> The last parameter can be omitted to receive information about all tasks.</p>
<h2>Configuration files details</h2>
<p>TODO : this is to be rewritten once we stabilize the configuration file format.</p>
<p>TODO : task, checker, general parameters</p>
<p>TODO review :</p>
<p>The QC requires a number of configuration items. An example config file is provided in the repo under the name <em>example-default.json</em>. Moreover, the outgoing channel over which histograms are sent is defined in a JSON file such as the one called <em>alfa.json</em> in the repo.</p>
<p><b>QC tasks</b> must be defined in the configuration within the element <code>qc/tasks_config</code> :</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&quot;tasks_config&quot;: {</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;   &quot;myTask_1&quot;: {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     &quot;taskDefinition&quot;: &quot;taskDefinition_1&quot;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;   },</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; ...</div></div><!-- fragment --><p>We use an indirect system to allow multiple tasks to share most of their definition (<code>myTask_1</code> uses defintion <code>taskDefinition_1</code>):</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;...</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  &quot;taskDefinition_1&quot;: {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    &quot;className&quot;: &quot;o2::quality_control_modules::example::ExampleTask&quot;,</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    &quot;moduleName&quot;: &quot;QcExample&quot;,</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    &quot;cycleDurationSeconds&quot;: &quot;10&quot;,</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    &quot;maxNumberCycles&quot;: &quot;-1&quot;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  },</div></div><!-- fragment --><p> The <code>moduleName</code> refers to which library contains the class <code>className</code>.</p>
<p>The data source for the task is defined in the section <code>qc/config/DataSampling</code> :</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  &quot;qc&quot;: {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    &quot;config&quot;: {</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;      &quot;DataSampling&quot;: {</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        &quot;implementation&quot;: &quot;MockSampler&quot;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;      },</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;...</div></div><!-- fragment --><p>Implementation can be <code>FairSampler</code> to get data from readout or <code>MockSampler</code> to get random data.</p>
<p>The JSON <code>alfa.json</code> file contains a typical FairMQ device definition. One can change the port or the address there: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    &quot;fairMQOptions&quot;: {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        &quot;devices&quot;: [</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;            {</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;                &quot;id&quot;: &quot;myTask_1&quot;,</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;                &quot;channels&quot;: [</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;                    {</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;                        &quot;name&quot;: &quot;data-out&quot;,</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                        &quot;sockets&quot;: [</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                            {</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                                &quot;type&quot;: &quot;pub&quot;,</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                                &quot;method&quot;: &quot;bind&quot;,</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                                &quot;address&quot;: &quot;tcp://*:5556&quot;,</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                                &quot;sndBufSize&quot;: 100,</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                                &quot;rcvBufSize&quot;: 100,</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                                &quot;rateLogging&quot;: 0</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                            }</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                        ]</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                    }</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                ]</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            }</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        ]</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    }</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div></div><!-- fragment --><p><b>QC checkers</b> are defined in the config file in section <code>checkers_config</code>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&quot;checkers_config&quot;: {</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  &quot;checker_0&quot;: {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    &quot;broadcast&quot;: &quot;0&quot;,</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    &quot;broadcastAddress&quot;: &quot;tcp://*:5600&quot;,</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    &quot;id&quot;: &quot;0&quot;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  },</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  ...</div></div><!-- fragment --><p>Here, <code>checker_0</code> is not going to broadcast its data but just store it in the database.</p>
<p>And for the time, the mapping between checkers and tasks must be explicit :</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;...</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;&quot;numberCheckers&quot;: &quot;1&quot;,</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;&quot;numberTasks&quot;: &quot;1&quot;,</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;&quot;tasksAddresses&quot;: &quot;tcp://localhost:5556,tcp://localhost:5557,tcp://localhost:5558,tcp://localhost:5559&quot;,</div></div><!-- fragment --><p> It is needed for the time being because we don't have an information service.</p>
<p>There are configuration items for many other aspects, for example the database connection, the monitoring or the data sampling. </p><hr/>
<p>← Go back to Modules Development | ../README.md "↑ Go to the Table of Content ↑" | Continue to Frequently Asked Questions → </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
